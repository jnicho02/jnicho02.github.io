<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <!-- Use title if it's in the page YAML frontmatter -->
    <title>

    Loading OpenStreetMap data on Mac OS X Mountain Lion</title>
    <!-- Bootstrap 4 alpha CSS -->
    <!-- IMPORTANT: Don't use this .css file in production. Use Bootstrap 3 until Bootstrap 4.0.0 is released. -->
    <link rel="stylesheet" href="https://cdn.rawgit.com/twbs/bootstrap/v4-dev/dist/css/bootstrap.css">

    <link href="/stylesheets/normalize.css" rel="stylesheet" /><link href="/stylesheets/all.css" rel="stylesheet" />
    <script src="/javascripts/all.js"></script>
  </head>

  <body class="x2012 x2012_10 x2012_10_31 x2012_10_31_postgresapp-plus-osm x2012_10_31_postgresapp-plus-osm_index">


        <nav class="navbar navbar-fixed-top navbar-dark bg-inverse">
      <!-- Brand -->
      <a class="navbar-brand" href="/"><img src="/images/jez.jpg" width="80em" class="img-circle pull-left" alt="Photo of Jez Nicholson"></a>
      <!-- Links -->
      <ul class="nav navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="/about/">About</a>
        </li>
      </ul>
    </nav>

    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <div class="container-fluid">
      <h1>Loading OpenStreetMap data on Mac OS X Mountain Lion</h1>
      <p>I recently installed PostgresApp http://postgresapp.com/ from Heroku on my Mac (OS X Mountain Lion) and am interested in OpenStreetMap data. PostgresApp includes postgis 2.0 as standard and appears to have hstore, although I am having slight difficulties with it.
1. install PostgresApp
2. download some test data from http://download.geofabrik.de/openstreetmap/ I guess I could have used wget, but I was exploring in Chrome so just downloaded it.
3. create an empty database
&gt; psql -h localhost
&gt; CREATE DATABASE osm_england;
&gt; \q</p>

<p>add hstore</p>

<ol>
  <li>configure postgis
&gt; psql -h localhost -d osm_england -f /Applications/Postgres.app/Contents/MacOS/share/contrib/postgis-2.0/postgis.sql
&gt; psql -h localhost -d osm_england -f /Applications/Postgres.app/Contents/MacOS/share/contrib/postgis-2.0/spatial_ref_sys.sql
&gt; psql -h localhost -d osm_england -f /Applications/Postgres.app/Contents/MacOS/share/contrib/postgis-2.0/topology.sql</li>
  <li>install osmosis
Osmosis is a Java application to load OSM data. I used homebrew. I normally use macports, but am using homebrew in parallel.
&gt; brew install osmosis</li>
  <li>create OSM 'simple' schema
&gt; psql -h localhost -d osm_england -f /usr/local/opt/osmosis/libexec/script/pgsimple_schema_0.6.sql
&gt; psql -h localhost -d osm_england -f /usr/local/opt/osmosis/libexec/script/pgsimple_schema_0.6_linestring.sql</li>
</ol>

<p>the 'linestring' bit will add a column to the ways table that will include all of the node points in a line. This could then be used by the Postgis function ST_MakeLine or ST_MakePolygon.</p>

<ol>
  <li>load OSM data
PostgresApp automatically creates a role (user) with your main Mac user's name, so use yours and not 'jeznicholson'.
&gt; osmosis –read-pbf file="Downloads/england.osm.pbf" –write-pgsimp database="osm_england" host="localhost" user="jeznicholson"</li>
</ol>

<blockquote>
  <p>Oct 24, 2012 7:13:16 PM org.openstreetmap.osmosis.core.Osmosis run
INFO: Pipeline executing, waiting for completion.
Oct 24, 2012 8:58:07 PM org.openstreetmap.osmosis.core.Osmosis run
INFO: Pipeline complete.
Oct 24, 2012 8:58:07 PM org.openstreetmap.osmosis.core.Osmosis run
INFO: Total execution time: 6290917 milliseconds.</p>
</blockquote>

    </div>

    <div class="container-fluid" name="tags">
        <a href="/tags/code/">
        <span class="label label-pill label-info pull-left">code</span>
        </a>
        <a href="/tags/osm/">
        <span class="label label-pill label-primary pull-left">osm</span>
        </a>
    </div>
    <div class="container">
  <span>It's All In The Game blog (c) 2005-16 by Jez Nicholson</span>
</div>
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-5854204-2', 'auto');
  ga('send', 'pageview');
</script>
<!-- Bootstrap 4 Alpha JS -->
<!-- IMPORTANT: Don't use this .js file in production. Use Bootstrap 3 until Bootstrap 4.0.0 is released. -->
<script src="https://cdn.rawgit.com/twbs/bootstrap/v4-dev/dist/js/bootstrap.js"></script> 

  </body>
</html>
