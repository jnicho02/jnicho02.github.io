<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>

    quick cloning in Hibernate</title>
    <!-- Bootstrap 4 alpha CSS -->
    <!-- IMPORTANT: Don't use this .css file in production. Use Bootstrap 3 until Bootstrap 4.0.0 is released. -->
    <link rel="stylesheet" href="https://cdn.rawgit.com/twbs/bootstrap/v4-dev/dist/css/bootstrap.css">

    <link href="/stylesheets/normalize.css" rel="stylesheet" /><link href="/stylesheets/all.css" rel="stylesheet" />
    <script src="/javascripts/all.js"></script>
  </head>

  <body class="x2006 x2006_07 x2006_07_01 x2006_07_01_quick-cloning-in-hibernate x2006_07_01_quick-cloning-in-hibernate_index">


        <nav class="navbar navbar-fixed-top navbar-dark bg-inverse">
      <!-- Brand -->
      <a class="navbar-brand" href="/"><img src="/images/jez.jpg" width="80em" class="img-circle pull-left" alt="Photo of Jez Nicholson"></a>
      <!-- Links -->
      <ul class="nav navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="#">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Link 2</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Contact</a>
        </li>
      </ul>
    </nav>

    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <div class="container-fluid">
      <h1>quick cloning in Hibernate</h1>
      <p>Yesterday, I was pondering why my system was a bit slow in performing a clone operation when I had an epiphany.</p>

<p>The system uses Hibernate with the objects extending a base object and implementing a primary key + version number. I had cunningly written a generic clone method that queries Hibernate metadata and copies the contents across to the new object. This works fine, but there is some reflection and new object instantiation in there, both of which take time. It also seems to take up a lot of memory on the client, but that may be a misnomer.</p>

<p>Part of the clone operation involves not copying the id and version from the original (or setting id to null and version to zero on the new object) so that Hibernate recognises it as a new object. This got me to thinking, why not traverse the object tree of the existing objects setting their ids to nullâ€¦.and then save them in Hibernate, making new records in the database! I might have to watch out for objects that aren't involved in a cascade-update and pre-save them, but it sounds much quicker to only work on the id + version.</p>

<p>There might be some problems if objects are already being referenced by screens or whatever as they will now be the cloned object, but seeing as this is a rare operation when I need to clone an entire project at one time then I can't see any problems. I'll follow up with a note when i've tried it out.</p>

    </div>

    <div class="container-fluid" name="tags">
        <a href="/tags/java/">
        <span class="label label-pill label-info pull-left">java</span>
        </a>
    </div>
    <div class="container">
  <span>It's All In The Game blog (c) 2005-16 by Jez Nicholson</span>
</div>
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-5854204-2', 'auto');
  ga('send', 'pageview');
</script>
<!-- Bootstrap 4 Alpha JS -->
<!-- IMPORTANT: Don't use this .js file in production. Use Bootstrap 3 until Bootstrap 4.0.0 is released. -->
<script src="https://cdn.rawgit.com/twbs/bootstrap/v4-dev/dist/js/bootstrap.js"></script> 

  </body>
</html>
